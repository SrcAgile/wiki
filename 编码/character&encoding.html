<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/tango.css">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <link rel="shortcut icon" href="/wiki/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/wiki/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <script type="text/x-mathjax-config">
       MathJax.Hub.Config({
         tex2jax: {inlineMath: [['$(',')$'], ['\\(','\\)']]}
       });
    </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <title>字符集与字符编码 - Meta's Wiki</title>
    <meta name="keywords" content=""/>
    <meta name="description" content=""/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/wiki/">Home</a>&nbsp;&#187;&nbsp;<a href="/wiki/#编码">编码</a>&nbsp;&#187;&nbsp;字符集与字符编码
    <span class="updated">Page Updated&nbsp;
      2016-11-12 12:10:33
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">字符集与字符编码</div>

  <p><strong>文档类型：</strong><a style="color:green;background-color:gray；font-style:bold">[引]</a></p>
<hr />
<ul>
<li><strong>今日音乐</strong></li>
</ul>
<div class="hlcode"><pre><span class="err">暂无评论</span>
</pre></div>


<hr />
<div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#_1">什么是字符集</a></li>
<li><a href="#_2">什么是字符编码</a></li>
<li><a href="#utf-8unicode">UTF-8和Unicode的关系</a></li>
<li><a href="#utf-8">UTF-8编码简介</a></li>
<li><a href="#_3">实践环节</a></li>
</ul>
</div>
<hr />
<h3 id="_1">什么是字符集</h3>
<hr />
<p>在介绍字符集之前，我们先了解下为什么要有字符集。我们在计算机屏幕上看到的是实体化的文字，而在计算机存储介质中存放的实际是二进制的比特流。那么在这两者之间的转换规则就需要一个统一的标准，否则把我们的U盘插到老式的电脑上，文档就乱码了；小伙伴QQ上传过来的文件，在我们本地打开又乱码了。于是为了实现转换标准，各种字符集标准就出现了。简单的说字符集就规定了某个文字对应的二进制数字存放方式（编码）和某串二进制数值代表了哪个文字（解码）的转换关系。 那么为什么会有那么多字符集标准呢？这个问题实际非常容易回答。问问自己为什么我们的插头拿到英国就不能用了呢？为什么显示器同时有DVI，VGA，HDMI，DP这么多接口呢？很多规范和标准在最初制定时并不会意识到这将会是以后全球普适的准则，或者处于组织本身利益就想从本质上区别于现有标准。于是，就产生了那么多具有相同效果但又不相互兼容的标准了。 说了那么多我们来看一个实际例子，下面就是<code>屌</code>这个字在各种编码下的十六进制和二进制编码结果，怎么样有没有一种很屌的感觉？</p>
<table>
<thead>
<tr>
<th align="center">字符集</th>
<th align="center">16进制编码</th>
<th align="center">对应的二进制数据</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">UTF-8</td>
<td align="center">0xE5B18C</td>
<td align="center">1110 0101 1011 0001 1000 1100</td>
</tr>
<tr>
<td align="center">UTF-16</td>
<td align="center">0x5C4C</td>
<td align="center">1011 1000 1001 1000</td>
</tr>
<tr>
<td align="center">GBK</td>
<td align="center">0x8CC5</td>
<td align="center">1000 1100 1100 0101</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="_2">什么是字符编码</h3>
<hr />
<p>字符集只是一个规则集合的名字，对应到真实生活中，字符集就是对某种语言的称呼。例如：英语，汉语，日语。对于一个字符集来说要正确编码转码一个字符需要三个关键元素：<b>字库表（character repertoire）</b>、<b>编码字符集（coded character set）</b>、<b>字符编码（character encoding form）</b>。其中字库表是一个相当于所有可读或者可显示字符的数据库，字库表决定了整个字符集能够展现表示的所有字符的范围。编码字符集，即用一个编码值code point来表示一个字符在字库中的位置。字符编码，将编码字符集和实际存储数值之间的转换关系。一般来说都会直接将code point的值作为编码后的值直接存储。例如在ASCII中A在表中排第65位，而编码后A的数值是0100 0001也即十进制的65的二进制转换结果。 看到这里，可能很多读者都会有和我当初一样的疑问：字库表和编码字符集看来是必不可少的，那既然字库表中的每一个字符都有一个自己的序号，直接把序号作为存储内容就好了。为什么还要多此一举通过字符编码把序号转换成另外一种存储格式呢？其实原因也比较容易理解：统一字库表的目的是为了能够涵盖世界上所有的字符，但实际使用过程中会发现真正用的上的字符相对整个字库表来说比例非常低。例如中文地区的程序几乎不会需要日语字符，而一些英语国家甚至简单的ASCII字库表就能满足基本需求。而如果把每个字符都用字库表中的序号来存储的话，每个字符就需要3个字节（这里以Unicode字库为例），这样对于原本用仅占一个字符的ASCII编码的英语地区国家显然是一个额外成本（存储体积是原来的三倍）。算的直接一些，同样一块硬盘，用ASCII可以存1500篇文章，而用3字节Unicode序号存储只能存500篇。于是就出现了UTF-8这样的变长编码。在UTF-8编码中原本只需要一个字节的ASCII字符，仍然只占一个字节。而像中文及日语这样的复杂字符就需要2个到3个字节来存储。</p>
<hr />
<h3 id="utf-8unicode">UTF-8和Unicode的关系</h3>
<hr />
<p>看完上面两个概念解释，那么解释UTF-8和Unicode的关系就比较简单了。Unicode就是上文中提到的编码字符集，而UTF-8就是字符编码，即Unicode规则字库的一种实现形式。随着互联网的发展，对同一字库集的要求越来越迫切，Unicode标准也就自然而然的出现。它几乎涵盖了各个国家语言可能出现的符号和文字，并将为他们编号。详见：Unicode on Wikipedia。Unicode的编号从0000开始一直到10FFFF共分为17个Plane，每个Plane中有65536个字符。而UTF-8则只实现了第一个Plane，可见UTF-8虽然是一个当今接受度最广的字符集编码，但是它并没有涵盖整个Unicode的字库，这也造成了它在某些场景下对于特殊字符的处理困难（下文会有提到）。</p>
<hr />
<h3 id="utf-8">UTF-8编码简介</h3>
<hr />
<p>为了更好的理解后面的实际应用，我们这里简单的介绍下UTF-8的编码实现方法。即UTF-8的物理存储和Unicode序号的转换关系。 UTF-8编码为变长编码。最小编码单位（code unit）为一个字节。一个字节的前1-3个bit为描述性部分，后面为实际序号部分。</p>
<ul>
<li>如果一个字节的第一位为0，那么代表当前字符为单字节字符，占用一个字节的空间。0之后的所有部分（7个bit）代表在Unicode中的序号。</li>
<li>如果一个字节以110开头，那么代表当前字符为双字节字符，占用2个字节的空间。110之后的所有部分（5个bit）加上后一个字节的除10外的部分（6个bit）代表在Unicode中的序号。且第二个字节以10开头</li>
<li>如果一个字节以1110开头，那么代表当前字符为三字节字符，占用3个字节的空间。110之后的所有部分（5个bit）加上后两个字节的除10外的部分（12个bit）代表在Unicode中的序号。且第二、第三个字节以10开头</li>
<li>如果一个字节以10开头，那么代表当前字节为多字节字符的第二个字节。10之后的所有部分（6个bit）和之前的部分一同组成在Unicode中的序号。</li>
</ul>
<p>具体每个字节的特征可见下表，其中x代表序号部分，把各个字节中的所有x部分拼接在一起就组成了在Unicode字库中的序号</p>
<p><a href="http://cenalulu.github.io/linux/character-encoding/">点击查看</a></p>
<hr />
<h3 id="_3">实践环节</h3>
<hr />
<div class="hlcode"><pre><span class="n">meta</span><span class="nd">@meta</span><span class="err">$</span>  <span class="n">LC_CTYPE</span><span class="o">=</span><span class="s">&quot;zh_CN.GBK&quot;</span>
<span class="n">meta</span><span class="nd">@meta</span><span class="err">$</span>  <span class="n">locale</span>
<span class="n">LANG</span><span class="o">=</span><span class="n">en_US</span><span class="o">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="n">LANGUAGE</span><span class="o">=</span><span class="n">en_US</span>
<span class="n">LC_CTYPE</span><span class="o">=</span><span class="n">zh_CN</span><span class="o">.</span><span class="n">GBK</span>
<span class="n">LC_NUMERIC</span><span class="o">=</span><span class="n">zh_CN</span><span class="o">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="n">LC_TIME</span><span class="o">=</span><span class="n">zh_CN</span><span class="o">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="n">LC_COLLATE</span><span class="o">=</span><span class="s">&quot;en_US.UTF-8&quot;</span>
<span class="n">LC_MONETARY</span><span class="o">=</span><span class="n">zh_CN</span><span class="o">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="n">LC_MESSAGES</span><span class="o">=</span><span class="s">&quot;en_US.UTF-8&quot;</span>
<span class="n">LC_PAPER</span><span class="o">=</span><span class="n">zh_CN</span><span class="o">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="n">LC_NAME</span><span class="o">=</span><span class="n">zh_CN</span><span class="o">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="n">LC_ADDRESS</span><span class="o">=</span><span class="n">zh_CN</span><span class="o">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="n">LC_TELEPHONE</span><span class="o">=</span><span class="n">zh_CN</span><span class="o">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="n">LC_MEASUREMENT</span><span class="o">=</span><span class="n">zh_CN</span><span class="o">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="n">LC_IDENTIFICATION</span><span class="o">=</span><span class="n">zh_CN</span><span class="o">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="n">LC_ALL</span><span class="o">=</span>
<span class="n">meta</span><span class="nd">@meta</span><span class="err">$</span> <span class="n">mkdir</span> <span class="err">哈</span>
<span class="n">meta</span><span class="nd">@meta</span><span class="err">$</span> <span class="n">ls</span> <span class="o">-</span><span class="n">a</span>
<span class="o">.</span>
<span class="o">..</span>
<span class="err">???</span>
<span class="n">meta</span><span class="nd">@meta</span><span class="err">$</span>  <span class="n">LC_CTYPE</span><span class="o">=</span><span class="s">&quot;zh_CN.UTF-8&quot;</span>
<span class="n">meta</span><span class="nd">@meta</span><span class="err">$</span>  <span class="n">ls</span>
<span class="o">.</span>
<span class="o">..</span>
<span class="err">哈</span>
</pre></div>


<div class="hlcode"><pre><span class="n">String</span> <span class="n">reqValue1</span><span class="o">=</span><span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">reqValue</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">&quot;UTF-8&quot;</span><span class="o">),</span><span class="s">&quot;GBK&quot;</span><span class="o">);</span>
<span class="err">#表示以</span><span class="n">utf8</span><span class="err">的方式获取一个含特定数量字节的序列然后以</span><span class="n">gbk</span><span class="err">的方式进行编码</span>
</pre></div>
  <div id="comments"></div>
  <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
  <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
  <script type="text/javascript">
  const gitment = new Gitment({
    title: '字符集与字符编码',
    owner: 'srcagile',
    repo: 'wiki',
    oauth: {
      client_id: '8d3768fea78397a633b8',
      client_secret: 'a79297700926ce00af68c66bc8ad1b06e6389cc0',
    },
    // ...
    // For more available options, check out the documentation below
  })
  gitment.render('comments')
  // or
  // gitment.render(document.getElementById('comments'))
  // or
  // document.body.appendChild(gitment.render())
  </script>
    </div>
    <div id="footer">
      <span>
        <p>Copyright © 2017 Guozhen Li.
          <a href='https://github.com/srcagile/wiki' style="color:red">Fork me on GitHub</a>
          <span id="cnzz_stat_icon_1256629854">
            <a href="http://www.cnzz.com/stat/website.php?web_id=1256629854" target="_blank" title="站长统计">
              <img border="0" hspace="0" vspace="0" src="http://icon.cnzz.com/img/pic.gif">
            </a>
          </span>
       </p>
        <p>Site Generated 2017-11-15 11:30:31</p>
      </span>
    </div>

    
    
  </body>

</html>